{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/tipo-gasto.service\";\nimport * as i2 from \"../../../services/auth.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction TipoGastoListComponent_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function TipoGastoListComponent_button_4_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.showCreateForm());\n    });\n    i0.ɵɵtext(1, \" Nuevo Tipo de Gasto \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TipoGastoListComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7)(1, \"h3\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"form\", 8);\n    i0.ɵɵlistener(\"ngSubmit\", function TipoGastoListComponent_div_5_Template_form_ngSubmit_3_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.onSubmit());\n    });\n    i0.ɵɵelementStart(4, \"div\", 9)(5, \"label\");\n    i0.ɵɵtext(6, \"C\\u00F3digo (Generado Autom\\u00E1ticamente)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"div\", 9)(9, \"label\");\n    i0.ɵɵtext(10, \"Descripci\\u00F3n *\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 11);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function TipoGastoListComponent_div_5_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.formData.descripcion, $event) || (ctx_r1.formData.descripcion = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"div\", 9)(13, \"label\")(14, \"input\", 12);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function TipoGastoListComponent_div_5_Template_input_ngModelChange_14_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.formData.activo, $event) || (ctx_r1.formData.activo = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(15, \" Activo \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 13)(17, \"button\", 14);\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function TipoGastoListComponent_div_5_Template_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancelForm());\n    });\n    i0.ɵɵtext(20, \" Cancelar \");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r1.isEditing ? \"Editar\" : \"Nuevo\", \" Tipo de Gasto\");\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"value\", ctx_r1.siguienteCodigo);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.formData.descripcion);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.formData.activo);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", !ctx_r1.formData.descripcion);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.isEditing ? \"Actualizar\" : \"Guardar\", \" \");\n  }\n}\nfunction TipoGastoListComponent_table_6_th_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\");\n    i0.ɵɵtext(1, \"Usuario\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction TipoGastoListComponent_table_6_tr_13_td_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const tipo_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(tipo_r5.nombreUsuario);\n  }\n}\nfunction TipoGastoListComponent_table_6_tr_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, TipoGastoListComponent_table_6_tr_13_td_5_Template, 2, 1, \"td\", 4);\n    i0.ɵɵelementStart(6, \"td\")(7, \"span\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"td\")(10, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function TipoGastoListComponent_table_6_tr_13_Template_button_click_10_listener() {\n      const tipo_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.showEditForm(tipo_r5));\n    });\n    i0.ɵɵtext(11, \" Editar \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function TipoGastoListComponent_table_6_tr_13_Template_button_click_12_listener() {\n      const tipo_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.deleteTipoGasto(tipo_r5.tipoGastoId));\n    });\n    i0.ɵɵtext(13, \" Eliminar \");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const tipo_r5 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(tipo_r5.codigo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(tipo_r5.descripcion);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isAdmin);\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleProp(\"color\", tipo_r5.activo ? \"green\" : \"red\");\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", tipo_r5.activo ? \"Activo\" : \"Inactivo\", \" \");\n  }\n}\nfunction TipoGastoListComponent_table_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\")(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4, \"C\\u00F3digo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6, \"Descripci\\u00F3n\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, TipoGastoListComponent_table_6_th_7_Template, 2, 0, \"th\", 4);\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"Estado\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Acciones\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"tbody\");\n    i0.ɵɵtemplate(13, TipoGastoListComponent_table_6_tr_13_Template, 14, 6, \"tr\", 16);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isAdmin);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.tiposGasto);\n  }\n}\nfunction TipoGastoListComponent_p_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 19);\n    i0.ɵɵtext(1, \" No hay tipos de gasto registrados \");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let TipoGastoListComponent = /*#__PURE__*/(() => {\n  class TipoGastoListComponent {\n    constructor(tipoGastoService, authService) {\n      this.tipoGastoService = tipoGastoService;\n      this.authService = authService;\n      this.tiposGasto = [];\n      this.showForm = false;\n      this.isEditing = false;\n      this.editingId = null;\n      this.siguienteCodigo = '';\n      this.isAdmin = false;\n      this.formData = {\n        descripcion: '',\n        activo: true\n      };\n    }\n    ngOnInit() {\n      this.isAdmin = this.authService.isAdmin();\n      this.loadTiposGasto();\n    }\n    loadTiposGasto() {\n      this.tipoGastoService.getAll().subscribe({\n        next: data => {\n          this.tiposGasto = data;\n        },\n        error: error => {\n          console.error('Error al cargar tipos de gasto:', error);\n          alert('Error al cargar tipos de gasto');\n        }\n      });\n    }\n    loadSiguienteCodigo() {\n      this.tipoGastoService.getSiguienteCodigo().subscribe({\n        next: data => {\n          this.siguienteCodigo = data.codigo;\n        },\n        error: error => {\n          console.error('Error al obtener siguiente código:', error);\n        }\n      });\n    }\n    showCreateForm() {\n      this.isEditing = false;\n      this.editingId = null;\n      this.formData = {\n        descripcion: '',\n        activo: true\n      };\n      this.showForm = true;\n      this.loadSiguienteCodigo();\n    }\n    showEditForm(tipoGasto) {\n      this.isEditing = true;\n      this.editingId = tipoGasto.tipoGastoId;\n      this.siguienteCodigo = tipoGasto.codigo;\n      this.formData = {\n        descripcion: tipoGasto.descripcion,\n        activo: tipoGasto.activo\n      };\n      this.showForm = true;\n    }\n    onSubmit() {\n      if (this.isEditing && this.editingId) {\n        this.tipoGastoService.update(this.editingId, this.formData).subscribe({\n          next: () => {\n            alert('Tipo de gasto actualizado exitosamente');\n            this.cancelForm();\n            this.loadTiposGasto();\n          },\n          error: error => {\n            console.error('Error al actualizar:', error);\n            alert('Error al actualizar tipo de gasto');\n          }\n        });\n      } else {\n        this.tipoGastoService.create(this.formData).subscribe({\n          next: () => {\n            alert('Tipo de gasto creado exitosamente');\n            this.cancelForm();\n            this.loadTiposGasto();\n          },\n          error: error => {\n            console.error('Error al crear:', error);\n            alert('Error al crear tipo de gasto');\n          }\n        });\n      }\n    }\n    cancelForm() {\n      this.showForm = false;\n      this.formData = {\n        descripcion: '',\n        activo: true\n      };\n      this.isEditing = false;\n      this.editingId = null;\n    }\n    deleteTipoGasto(id) {\n      if (confirm('¿Está seguro de eliminar este tipo de gasto?\\n\\nNota: Solo se pueden eliminar tipos de gasto que no tengan gastos o presupuestos registrados.')) {\n        this.tipoGastoService.delete(id).subscribe({\n          next: () => {\n            alert('Tipo de gasto eliminado exitosamente');\n            this.loadTiposGasto();\n          },\n          error: error => {\n            console.error('Error al eliminar:', error);\n            // Extraer el mensaje de error del backend\n            let mensajeError = 'Error al eliminar tipo de gasto';\n            if (error.error && typeof error.error === 'string') {\n              mensajeError = error.error;\n            } else if (error.error && error.error.message) {\n              mensajeError = error.error.message;\n            } else if (error.message) {\n              mensajeError = error.message;\n            }\n            alert(mensajeError);\n          }\n        });\n      }\n    }\n    static {\n      this.ɵfac = function TipoGastoListComponent_Factory(t) {\n        return new (t || TipoGastoListComponent)(i0.ɵɵdirectiveInject(i1.TipoGastoService), i0.ɵɵdirectiveInject(i2.AuthService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: TipoGastoListComponent,\n        selectors: [[\"app-tipo-gasto-list\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 8,\n        vars: 4,\n        consts: [[1, \"card\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-3\"], [\"class\", \"btn btn-primary\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"card mb-3\", \"style\", \"background-color: #f8f9fa;\", 4, \"ngIf\"], [4, \"ngIf\"], [\"class\", \"text-center\", 4, \"ngIf\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [1, \"card\", \"mb-3\", 2, \"background-color\", \"#f8f9fa\"], [3, \"ngSubmit\"], [1, \"form-group\"], [\"type\", \"text\", \"readonly\", \"\", 1, \"form-control\", 3, \"value\"], [\"type\", \"text\", \"name\", \"descripcion\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"checkbox\", \"name\", \"activo\", 3, \"ngModelChange\", \"ngModel\"], [1, \"d-flex\", 2, \"gap\", \"10px\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-primary\", 2, \"margin-right\", \"5px\", 3, \"click\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"text-center\"]],\n        template: function TipoGastoListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵtext(3, \"Tipos de Gasto\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(4, TipoGastoListComponent_button_4_Template, 2, 0, \"button\", 2);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(5, TipoGastoListComponent_div_5_Template, 21, 6, \"div\", 3)(6, TipoGastoListComponent_table_6_Template, 14, 2, \"table\", 4)(7, TipoGastoListComponent_p_7_Template, 2, 0, \"p\", 5);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngIf\", !ctx.showForm);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showForm);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.tiposGasto.length > 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.tiposGasto.length === 0);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, FormsModule, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.CheckboxControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n        styles: [\"h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:20px}.card[_ngcontent-%COMP%]{margin-bottom:20px;width:100%;max-width:100%}table[_ngcontent-%COMP%]{width:100%;margin-top:20px;table-layout:auto}button[_ngcontent-%COMP%]{font-size:14px}\"]\n      });\n    }\n  }\n  return TipoGastoListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}